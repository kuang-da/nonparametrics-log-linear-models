## Skillings and Mack (1981), Table 1 page 173
## Comparison of four methods of assembling a product
B <- rep(c(1,2,3,4,5,6,7,8,9),rep(4,9))
G <- rep(c('A','B','C','D'),9)
y <- c(3.2,4.1,3.8,4.2, 3.1,3.9,3.4,4.0, 4.3,3.5,4.6,4.8,
3.5,3.6,3.9,4.0, 3.6,4.2,3.7,3.9, 4.5,4.7,3.7, NA,
NA ,4.2,3.4,NA , 4.3,4.6,4.4,4.9, 3.5, NA,3.7, 3.9)
Ski.Mack(y,groups = G,blocks = B)
# Skillings-Mack Statistic =  15.493049 , p-value =  0.001440 
# Note: the p-value is based on the chi-squared distribution with d.f. =  3 

# $Nblocks
# [1] 9

# $Ntreatments
# [1] 4

# $rawdata
#      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
# [1,]  3.2  3.1  4.3  3.5  3.6  4.5   NA  4.3  3.5
# [2,]  4.1  3.9  3.5  3.6  4.2  4.7  4.2  4.6   NA
# [3,]  3.8  3.4  4.6  3.9  3.7  3.7  3.4  4.4  3.7
# [4,]  4.2  4.0  4.8  4.0  3.9   NA   NA  4.9  3.9

# $rankdata
#      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
# [1,]    1    1    2    1    1    2  1.5    1    1
# [2,]    3    3    1    2    4    3  2.0    3    2
# [3,]    2    2    3    3    2    1  1.0    2    2
# [4,]    4    4    4    4    3    2  1.5    4    3

# $varCovarMatrix
#      [,1] [,2] [,3] [,4]
# [1,]   22   -7   -8   -7
# [2,]   -7   21   -8   -6
# [3,]   -8   -8   23   -7
# [4,]   -7   -6   -7   20

# $adjustedSum
#              [,1]        [,2]         [,3]        [,4]
# [1,] -14.12559752 4.281244146 -4.281244146 14.12559752
## y is a matrix

maty <- matrix(
c(3.2,4.1,3.8,4.2,3.1,3.9,3.4,4.0, 4.3,3.5,4.6,4.8,
3.5,3.6,3.9,4.0, 3.6,4.2,3.7,3.9, 4.5,4.7,3.7, NA,
NA ,4.2,3.4,NA , 4.3,4.6,4.4,4.9, 3.5, NA,3.7, 3.9),
ncol=9,byrow=FALSE)
Ski.Mack(maty, simulate.p.value = TRUE, B = 1000)
# Skillings-Mack Statistic =  15.493049 , p-value =  0.001440 
# Note: the p-value is based on the chi-squared distribution with d.f. =  3 
# Based on B =  1000 , Simulated p-value =  0.000000 

# $Nblocks
# [1] 9

# $Ntreatments
# [1] 4

# $rawdata
#      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
# [1,]  3.2  3.1  4.3  3.5  3.6  4.5   NA  4.3  3.5
# [2,]  4.1  3.9  3.5  3.6  4.2  4.7  4.2  4.6   NA
# [3,]  3.8  3.4  4.6  3.9  3.7  3.7  3.4  4.4  3.7
# [4,]  4.2  4.0  4.8  4.0  3.9   NA   NA  4.9  3.9

# $rankdata
#      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
# [1,]    1    1    2    1    1    2  1.5    1    1
# [2,]    3    3    1    2    4    3  2.0    3    2
# [3,]    2    2    3    3    2    1  1.0    2    2
# [4,]    4    4    4    4    3    2  1.5    4    3

# $varCovarMatrix
#      [,1] [,2] [,3] [,4]
# [1,]   22   -7   -8   -7
# [2,]   -7   21   -8   -6
# [3,]   -8   -8   23   -7
# [4,]   -7   -6   -7   20

# $adjustedSum
#              [,1]        [,2]         [,3]        [,4]
# [1,] -14.12559752 4.281244146 -4.281244146 14.12559752